!function(e){var o={};function t(s){if(o[s])return o[s].exports;var r=o[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=o,t.d=function(e,o,s){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:s})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var r in e)t.d(s,r,function(o){return e[o]}.bind(null,r));return s},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=0)}([function(e,o,t){"use strict";t.r(o);const s=new DOMParser;var r=e=>{if("function"!=typeof e.template)throw new Error("a component must be initialized with a template \nfunction that returns an html string");const o=function(o){if(this.events={},this.init=()=>{},this.postRender=()=>{},this.propTypes={},this.checkPropTypes=!1,Object.assign(this,e),this.checkPropTypes)for(const e in this.propTypes)if(typeof o[e]!==this.propTypes[e])throw new Error(`The required type for the prop ${e} is     ${this.propTypes[e]}. Received ${o[e]}`);this.props=o||{},this.init()};return o.prototype={assignEventHandlers(){Object.keys(this.events).map(e=>{const[o,t]=e.split(" "),s=this.events[e];this.tree.querySelector(o).addEventListener(t,s.bind(this))})},render(){return this.tree=s.parseFromString(this.template(),"text/html").body.children[0],this.tree.$=(e=>this.tree.querySelector(e)).bind(this),this.tree.$$=(e=>this.tree.querySelectorAll(e)).bind(this),this.assignEventHandlers(),this.postRender(),this.tree},mount(e){e.innerHTML="",e.appendChild(this.render())}},o},n=r({propTypes:{book:"object"},template(){return`<li class="book-item">\n                <h4 class="book-title">${this.props.book.title}</h4>\n                <div class="details">\n                    <div class="thumbnail">\n                        <img src="\n                        ${this.props.book.imageLinks?this.props.book.imageLinks.smallThumbnail:"https://via.placeholder.com/133x205.png?text=No%20Image"}\n                        " />\n                    </div>\n                    <div class="metadata">\n                        <p class="book-authors">Authors: ${this.props.book.authors?this.props.book.authors.join(", "):"N/A"}</p>\n                        <p class="publishing-company">Publisher: ${this.props.book.publisher||"Not listed"}</p>\n                        ${this.props.book.infoLink?`<a class="learn-more" href="${this.props.book.infoLink}" target="_blank">Learn more</a>`:""}\n                    </div>\n                </div>\n            </li>`}}),i=r({propTypes:{books:"object",booksLoaded:"boolean",booksLoading:"boolean"},template(){let e="";if(this.props.booksLoaded)if(this.props.totalBooks){e=`There are ${parseInt(this.props.totalBooks).toLocaleString()} books that match your search query. Displaying results 1 - 10.`}else e="No books match your search query.";let o="",t="";return this.props.booksLoading&&(o='<img alt="loading-gif" src="/static/loader.gif"/>',t="Loading..."),`<div class="results-area">\n                <p class="results-message">${e}</p>\n                <div class="loading-area" >\n                    <p class="loading-message">${t}</p>\n                    <div class="loading-gif">${o}</div>\n                </div>\n                <ul class="book-list"></ul>\n            </div>`},postRender(){this.props.booksLoaded&&this.props.books.forEach(e=>{this.tree.$(".book-list").appendChild(new n({book:e.volumeInfo}).render())})}}),a=r({propTypes:{focus:"boolean",error:"boolean",onSubmit:"function",onInvalidSubmission:"function"},template(){const e=this.props.error?"Please enter a search term.":"";return`<div class="search-area">\n                <h3>Swearch our catalog</h3>\n                <form class="search-form">\n                    <input \n                        class="search-input ${this.props.error?"error":""}" \n                        id="search-input" \n                        name="search-input" \n                        tabindex="0"\n                        placeholder="Enter a search term" />\n                    <button type="submit">Go</button>\n                </form>\n                <p class="error-message">${e}</p>\n            </div>`},events:{".search-input focus":function(e){this.props.onFocus()},".search-form submit":function(e){e.preventDefault();const o=this.tree.$(".search-input").value;o?this.props.onSubmit(o):this.props.onInvalidSubmission()}},postRender:function(){if(this.props.focus){const e=this;setTimeout(()=>{e.tree.$(".search-input").focus()},50)}}});const p={events:{},data:{books:[],booksLoaded:!1,booksLoading:!1,formInvalid:!1,searchError:!1,searchFocus:!1},get:e=>p.data[e],getState:()=>p.data,set:e=>{p.data=Object.assign(p.data,e),p.trigger("update")},on:(e,o)=>{const t=p.events[e];p.events[e]=t?[...t,o]:[o]},trigger:(e,...o)=>{p.events[e].forEach(e=>e(...o))}},h=p.set.bind(p);var c=p,l=r({template:()=>'<div class="home-page">\n                <div class="header">\n                    <h1>Welcome to The Library</h1>\n                    <i>Shhh!</i>\n                </div>\n                <div class="page-body">\n                </div>\n            </div>',postRender(){const e={error:this.props.formInvalid,focus:this.props.searchFocus,onFocus:()=>{this.props.formInvalid&&h({formInvalid:!1,searchFocus:!0})},onInvalidSubmission:()=>{h({formInvalid:!0,searchFocus:!1})},onSubmit:e=>{h({booksLoading:!0,booksLoaded:!1}),(e=>{if(void 0===e)throw new Error("fetchBooks() must be invoked with a search term.");const o=((e,o)=>`${e}?q=${o}`)("/book-search",e);return fetch(o).then(e=>e.json()).then(e=>({...e,searchEndpoint:o})).catch(e=>{throw new Error(e)})})(e).then(e=>{h({books:e.items||[],booksLoaded:!0,booksLoading:!1,totalBooks:e.totalItems})})}},o={books:this.props.books,totalBooks:this.props.totalBooks,booksLoaded:this.props.booksLoaded,booksLoading:this.props.booksLoading};this.tree.querySelector(".page-body").appendChild(new a(e).render()).parentNode.appendChild(new i(o).render())}});const d=()=>{new l(c.getState()).mount(document.body)};c.on("update",d),d()}]);